<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CTF Login</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html, body {
  margin:0; padding:0; height:100%;
  font-family:"Courier New", monospace;
  overflow:hidden;
  background:#000;
  color:#0ff;
  text-align:center;
}
#starfield { position:fixed; top:0; left:0; width:100%; height:100%; z-index:0; }
#cyber-text {
  position:absolute; top:10px; left:10px; font-size:1.5rem;
  color:#fff; z-index:2; font-weight:bold; text-shadow:0 0 10px #fff;
}
#content {
  position:relative; z-index:1;
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  min-height:100vh; padding:24px;
  color:#0ff;
}
h1,h2 { font-size:3rem; color:#f0f; text-shadow:0 0 15px #f0f; margin-bottom:20px;}
input, button { font-size:18px; margin:10px; padding:10px; border:1px solid #0ff; background:rgba(17,17,17,0.85); color:#0ff; border-radius:10px; width:min(420px,90vw); }
button { cursor:pointer; font-weight:700; }
a { color:#f0f; margin-top:10px; text-decoration:none; }
</style>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

// SB1 Firebase config
const firebaseConfig1 = {
  apiKey:"AIzaSyCkblbbA7iZmiGr617-KZB8Yd3H3a2Aq4M",
  authDomain:"ctfscoreboard-3af1b.firebaseapp.com",
  projectId:"ctfscoreboard-3af1b"
};
const app1 = initializeApp(firebaseConfig1, "SB1");
const auth1 = getAuth(app1);

// SB2 Firebase config
const firebaseConfig2 = {
  apiKey:"AIzaSyBsxWCAiMAvznvav9F8OO16I_lCcCfbJG8",
  authDomain:"ctf-scoreboard2.firebaseapp.com",
  projectId:"ctf-scoreboard2"
};
const app2 = initializeApp(firebaseConfig2, "SB2");
const auth2 = getAuth(app2);

// Redirect if already logged in on any board
onAuthStateChanged(auth1, (user)=>{
  if(user && user.email && user.email.endsWith("@player.local")){
    window.location.href = "index.html";
  }
});
onAuthStateChanged(auth2, (user)=>{
  if(user && user.email && user.email.endsWith("@player.local")){
    window.location.href = "index.html";
  }
});

window.loginUser = async function(){
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value.trim();
  if(!username || !password){ alert("All fields required"); return;}
  const email = `${username}@player.local`;

  try {
    // Try SB1
    await signInWithEmailAndPassword(auth1, email, password);
    window.location.href = "index.html";
    return;
  } catch(e1){
    try {
      // Try SB2
      await signInWithEmailAndPassword(auth2, email, password);
      window.location.href = "index.html";
      return;
    } catch(e2){
      alert("‚ùå Invalid credentials");
    }
  }
}
</script>
</head>
<body>
<canvas id="starfield"></canvas>
<div id="cyber-text">BY Cyb3rMaF1a</div>

<div id="content">
  <h1>Player Login</h1>
  <input id="username" placeholder="Username">
  <input id="password" type="password" placeholder="Password">
  <button onclick="loginUser()">Login</button>
  <div>
    <a href="register.html">No account? Register</a> &nbsp;|&nbsp; <a href="admin-login.html">Admin Login</a>
  </div>
</div>

<script>
// Canvas setup
const canvas = document.getElementById('starfield');
const ctx = canvas.getContext('2d');
let width = canvas.width = window.innerWidth;
let height = canvas.height = window.innerHeight;
window.addEventListener('resize', () => { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; });

// Stars
const stars = [];
for(let i=0;i<400;i++){
  stars.push({x:Math.random()*width, y:Math.random()*height, r:Math.random()*2+0.5, blinkSpeed: Math.random()*0.05 + 0.02, opacity: Math.random()});
}

// Top-left blinking text
const cyberText = document.getElementById('cyber-text');
function blinkText(){
  cyberText.style.opacity = Math.random()>0.5 ? 1 : 0.2;
  setTimeout(blinkText, 200 + Math.random()*300);
}
blinkText();

// Animate stars
function animate(){
  ctx.fillStyle = '#000';
  ctx.fillRect(0,0,width,height);

  for(let s of stars){
    s.opacity += s.blinkSpeed * (Math.random()>0.5?1:-1);
    if(s.opacity>1) s.opacity=1;
    if(s.opacity<0) s.opacity=0;
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fillStyle=`rgba(255,255,255,${s.opacity})`;
    ctx.fill();
  }

  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
